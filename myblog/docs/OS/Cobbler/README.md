# Cobbler自动化系统安装环境配置

[[toc]]

网络安装服务器套件 Cobbler(补鞋匠)是RedHat在2008年发布的，用于快速建立Linux网络安装环境。今天我们就用Cobbler来配置一套自动化系统安装环境。

## 0. 参考文档

- Cobbler官方文档：[https://cobbler.readthedocs.io/en/latest/](https://cobbler.readthedocs.io/en/latest/)
- Cobbler官网地址：[https://github.com/cobbler/cobbler](https://github.com/cobbler/cobbler)

此处复制一段 [Cobbler自动化部署](https://www.cnblogs.com/yanjieli/p/11016825.html) 中的介绍。

> ## cobbler简介
>
> 1、`Cobbler`是一个`Linux`服务器安装的服务，可以通过网络启动（`PXE`）的方式来快速安装、重装物理服务器和虚拟机，同时还可以管理`DHCP`，`DNS`等。
> 2、`Cobbler`可以使用命令行方式管理，也提供了基于Web的界面管理工具（`cobbler-web`），还提供了`API`接口，可以方便二次开发使用。
> 3、`Cobbler`是较早前的`kickstart`的升级版，优点是比较容易配置，还自带web界面比较易于管理。
> 4、`Cobbler`内置了一个轻量级配置管理系统，但它也支持和其它配置管理系统集成，如`Puppet`。
>
> ## cobbler集成的服务
>
> - PXE服务支持
> - DHCP服务管理
> - DNS服务管理
> - 电源管理
> - Kickstart服务支持
> - YUM仓库管理
> - TFTP
> - Apache
>
> ## cobbler工作原理
> **Server端**
>
> - 启动`Cobbler`服务
> - 进行`Cobbler`错误检查，执行`cobbler check`命令
> - 进行配置同步，执行`cobbler sync`命令
> - 复制相关启动文件到`TFTP`目录中
> - 启动`DHCP`服务，提供地址分配
> - `DHCP`服务分配IP地址
> - `TFTP`传输启动文件
> - `Server`端接收安装信息
> - `Server`端发送`ISO`镜像与`Kickstart`文件
>
> **Client端**
>
> - 客户端以`PXE`模式启动
> - 客户端获取`IP`地址
> - 通过`TFTP`服务器获取启动文件
> - 进入`Cobbler`安装选择界面
> - 根据配置信息准备安装系统
> - 加载`Kickstart`文件
> - 传输系统安装的其它文件
> - 进行安装系统
>
> 作者：别来无恙-
>
> 出处：https://www.cnblogs.com/yanjieli/p/11016825.html
>
> 版权：本作品采用「[署名-非商业性使用-相同方式共享 4.0 国际](https://creativecommons.org/licenses/by-nc-sa/4.0/)」许可协议进行许可。



## 1. 环境说明

- 宿主机：系统`Ubuntu 20.04.2 LTS`，IP:192.168.2.113。
- 虚拟化工具：VirtualBox 6.1.22。
- 虚拟机: 采用桥接网卡创建一个CentOS7虚拟机，命名为`cobbler-master`。

虚拟机创建注意事项：

- `VirtualBox`中设置虚拟机内存大小2048MB。
- `VirtualBox`中设置虚拟机虚拟分配空间40GB，此处空间稍微分配大一点，因为需要存放系统镜像，可能会占用较多空间。
- `VirtualBox`中设置虚拟机配置网卡1，启用网络连接，并设置连接方式为"桥接网卡"。

虚拟机其他信息：

操作系统：

```sh
[root@cobbler-master ~]# cat /etc/centos-release
CentOS Linux release 7.9.2009 (Core)
```

配置静态IP地址:

```sh
[root@cobbler-master ~]# cat /etc/sysconfig/network-scripts/ifcfg-enp0s3 
TYPE="Ethernet"
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="none"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="enp0s3"
UUID="cde3dfd3-712f-40a3-9ab7-aa8d0fc31448"
DEVICE="enp0s3"
ONBOOT="yes"
IPADDR="192.168.2.20"
PREFIX="24"
GATEWAY="192.168.2.1"
IPV6_PRIVACY="no"
DNS1="192.168.2.1"
[root@localhost ~]# 
```

在安装虚拟机过程中，可以在网络配置时先选择DHCP方式自动连接网络，网络连接成功后，可以看到IP、网关、子网掩码、DNS等信息，将其记录下来，然后手动配置IP即可。

查看IP、网关、子网掩码、DNS等信息：

```sh
# IP信息,此处的192.168.2.20就是虚拟机的IP地址
[root@cobbler-master ~]# ip a show enp0s3
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:87:c2:4e brd ff:ff:ff:ff:ff:ff
    inet 192.168.2.20/24 brd 192.168.2.255 scope global noprefixroute enp0s3
       valid_lft forever preferred_lft forever
    inet6 fe80::d972:e36b:31ff:8dd1/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever

# 网关信息，此处第2列的192.168.2.1就是网关IP地址
# 子网掩码信息，此处第3列的255.255.255.0则是子网掩码
[root@cobbler-master ~]# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.2.1     0.0.0.0         UG    100    0        0 enp0s3
192.168.2.0     0.0.0.0         255.255.255.0   U     100    0        0 enp0s3

# DNS域名服务器信息，此处的192.168.2.1则是域名服务器IP地址
[root@cobbler-master ~]# cat /etc/resolv.conf 
# Generated by NetworkManager
nameserver 192.168.2.1
```

记录好这些信息，后面配置Cobbler DHCP时需要使用到。



另外，我们关闭VirtualBox主机网络管理器中的"DHCP服务器"，不启用服务器即可。



后续操作，除特殊说明外，都在在虚拟机`cobbler-master`中操作的。

## 2. YUM源配置

为了加快下载速度,我们将CentOS-Base源更新为国内的华为镜像。

```sh
[root@cobbler-master ~]# wget -O /etc/yum.repos.d/CentOS-Base.repo https://repo.huaweicloud.com/repository/conf/CentOS-7-reg.repo
--2021-06-19 08:06:58--  https://repo.huaweicloud.com/repository/conf/CentOS-7-reg.repo
Resolving repo.huaweicloud.com (repo.huaweicloud.com)... 58.49.156.108, 58.49.156.106, 58.49.156.107, ...
Connecting to repo.huaweicloud.com (repo.huaweicloud.com)|58.49.156.108|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1775 (1.7K) [application/octet-stream]
Saving to: ‘/etc/yum.repos.d/CentOS-Base.repo’

100%[=====================================>] 1,775       --.-K/s   in 0s      

2021-06-19 08:06:58 (96.4 MB/s) - ‘/etc/yum.repos.d/CentOS-Base.repo’ saved [1775/1775]

[root@cobbler-master ~]# 
```

配置清华大学的EPEL源镜像：

```sh
cat > /etc/yum.repos.d/epel.repo << EOF
[epel]
name=Extra Packages for Enterprise Linux 7 - \$basearch
baseurl=https://mirrors.tuna.tsinghua.edu.cn/epel/7/\$basearch
#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=\$basearch
failovermethod=priority
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7

[epel-debuginfo]
name=Extra Packages for Enterprise Linux 7 - \$basearch - Debug
baseurl=https://mirrors.tuna.tsinghua.edu.cn/epel/7/\$basearch/debug
#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-debug-7&arch=\$basearch
failovermethod=priority
enabled=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
gpgcheck=1

[epel-source]
name=Extra Packages for Enterprise Linux 7 - \$basearch - Source
baseurl=https://mirrors.tuna.tsinghua.edu.cn/epel/7/SRPMS
#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-source-7&arch=\$basearch
failovermethod=priority
enabled=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
gpgcheck=1
EOF
```

参考：[https://mirrors.tuna.tsinghua.edu.cn/help/epel/](https://mirrors.tuna.tsinghua.edu.cn/help/epel/)

## 3. 关闭Selinux

官方文档中关于Selinux的说明：

> Before getting started with Cobbler, it may be convenient to either disable SELinux or set it to “permissive” mode, especially if you are unfamiliar with SELinux troubleshooting or modifying SELinux policy. Cobbler constantly evolves to assist in managing new system technologies, and the policy that ships with your OS can sometimes lag behind the feature-set we provide, resulting in AVC denials that break Cobbler’s functionality.

大意是操作系统提供的特征策略有可能比Cobbler提供的功能集后滞后,因此建议关闭SELinux。

```sh
[root@cobbler-master ~]# getenforce 
Disabled
[root@cobbler-master ~]# cat /etc/selinux/config 

# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
SELINUX=disabled
# SELINUXTYPE= can take one of three values:
#     targeted - Targeted processes are protected,
#     minimum - Modification of targeted policy. Only selected processes are protected. 
#     mls - Multi Level Security protection.
SELINUXTYPE=targeted 
```

确保`getenforce`获取到在值是`Disabled`，如果不是的话，可以使用VIM打开配置文件`/etc/selinux/config`，将其第7行修改为`SELINUX=disabled`。修改完成后，使用命令`shutdown -r now`重启虚拟机。

## 4. cobbler安装

参考：[https://cobbler.readthedocs.io/en/latest/installation-guide.html](https://cobbler.readthedocs.io/en/latest/installation-guide.html)

```
httpd： 通过web服务检测管理cobbler
rsync： 远程同步管理、同步dhcp
xinetd：管理rsync、tftp-server服务
tftp-server：tftp简单文件传输包，传输启动文件
dhcp: DHCP服务分配IP地址
pykickstart：无人值守安装模板，即应答文件
cobbler：cobbler主包,cobbler的核心
cobbler-web：cobbler支持web服务包（图形化界面）
```

安装：

```sh
[root@cobbler-master ~]# yum install httpd xinetd tftp-server dhcp  pykickstart cobbler cobbler-web -y
... 省略
Installed:
  cobbler.x86_64 0:2.8.5-0.3.el7        cobbler-web.noarch 0:2.8.5-0.3.el7    
  dhcp.x86_64 12:4.2.5-83.el7.centos.1  pykickstart.noarch 0:1.99.66.22-1.el7 
  tftp-server.x86_64 0:5.2-22.el7       xinetd.x86_64 2:2.3.15-14.el7         

Dependency Installed:
  PyYAML.x86_64 0:3.10-11.el7                                                  
  createrepo.noarch 0:0.9.9-28.el7                                             
  deltarpm.x86_64 0:3.6-3.el7                                                  
  genisoimage.x86_64 0:1.1.11-25.el7                                           
  jbigkit-libs.x86_64 0:2.0-11.el7                                             
  libjpeg-turbo.x86_64 0:1.2.90-8.el7                                          
  libtiff.x86_64 0:4.0.3-35.el7                                                
  libusal.x86_64 0:1.1.11-25.el7                                               
  libwebp.x86_64 0:0.3.0-10.el7_9                                              
  libxml2-python.x86_64 0:2.9.1-6.el7.5                                        
  libyaml.x86_64 0:0.1.4-11.el7_0                                              
  mod_ssl.x86_64 1:2.4.6-97.el7.centos                                         
  mod_wsgi.x86_64 0:3.4-18.el7                                                 
  mtools.x86_64 0:4.0.18-5.el7                                                 
  python-backports.x86_64 0:1.0-8.el7                                          
  python-backports-ssl_match_hostname.noarch 0:3.5.0.1-1.el7                   
  python-chardet.noarch 0:2.2.1-3.el7                                          
  python-cheetah.x86_64 0:2.4.4-5.el7.centos                                   
  python-deltarpm.x86_64 0:3.6-3.el7                                           
  python-django-bash-completion.noarch 0:1.11.27-1.el7                         
  python-ipaddress.noarch 0:1.0.16-2.el7                                       
  python-kitchen.noarch 0:1.1.1-5.el7                                          
  python-netaddr.noarch 0:0.7.5-9.el7                                          
  python-pillow.x86_64 0:2.0.0-21.gitd1c6db8.el7                               
  python-pygments.noarch 0:1.4-10.el7                                          
  python-setuptools.noarch 0:0.9.8-7.el7                                       
  python2-django.noarch 0:1.11.27-1.el7                                        
  python2-markdown.noarch 0:2.4.1-4.el7                                        
  python2-pyyaml.noarch 0:3.10-0.el7                                           
  python2-simplejson.x86_64 0:3.10.0-2.el7                                     
  pytz.noarch 0:2016.10-2.el7                                                  
  rsync.x86_64 0:3.1.2-10.el7                                                  
  syslinux.x86_64 0:4.05-15.el7                                                
  yum-utils.noarch 0:1.1.31-54.el7_8                                           

Dependency Updated:
  dhclient.x86_64 12:4.2.5-83.el7.centos.1                                     
  dhcp-common.x86_64 12:4.2.5-83.el7.centos.1                                  
  dhcp-libs.x86_64 12:4.2.5-83.el7.centos.1                                    

Complete!
[root@cobbler-master ~]# 
```

## 5. 启动cobblerd服务

我们先启动httpd服务，再启动cobblerd服务。

```sh
# 启动服务
[root@cobbler-master ~]# systemctl start httpd cobblerd

# 添加开机启动
[root@cobbler-master ~]# systemctl enable httpd cobblerd
Created symlink from /etc/systemd/system/multi-user.target.wants/httpd.service to /usr/lib/systemd/system/httpd.service.
Created symlink from /etc/systemd/system/multi-user.target.wants/cobblerd.service to /usr/lib/systemd/system/cobblerd.service.

查看httpd和cobblerd服务状态
[root@cobbler-master ~]# systemctl status httpd cobblerd
● httpd.service - The Apache HTTP Server
   Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; vendor preset: disabled)
   Active: active (running) since 六 2021-06-19 09:07:17 CST; 36s ago
     Docs: man:httpd(8)
           man:apachectl(8)
 Main PID: 1683 (httpd)
   Status: "Total requests: 0; Current requests/sec: 0; Current traffic:   0 B/sec"
   CGroup: /system.slice/httpd.service
           ├─1683 /usr/sbin/httpd -DFOREGROUND
           ├─1687 (wsgi:cobbler_w -DFOREGROUND
           ├─1688 /usr/sbin/httpd -DFOREGROUND
           ├─1689 /usr/sbin/httpd -DFOREGROUND
           ├─1690 /usr/sbin/httpd -DFOREGROUND
           ├─1691 /usr/sbin/httpd -DFOREGROUND
           └─1692 /usr/sbin/httpd -DFOREGROUND

6月 19 09:07:17 cobbler-master systemd[1]: Starting The Apache HTTP Server...
6月 19 09:07:17 cobbler-master httpd[1683]: AH00558: httpd: Could not reli...e
6月 19 09:07:17 cobbler-master systemd[1]: Started The Apache HTTP Server.

● cobblerd.service - Cobbler Helper Daemon
   Loaded: loaded (/usr/lib/systemd/system/cobblerd.service; enabled; vendor preset: disabled)
   Active: active (running) since 六 2021-06-19 09:07:17 CST; 36s ago
 Main PID: 1684 (cobblerd)
   CGroup: /system.slice/cobblerd.service
           └─1684 /usr/bin/python2 -s /usr/bin/cobblerd -F

6月 19 09:07:17 cobbler-master systemd[1]: Starting Cobbler Helper Daemon...
6月 19 09:07:17 cobbler-master systemd[1]: Started Cobbler Helper Daemon.
Hint: Some lines were ellipsized, use -l to show in full.
[root@cobbler-master ~]# 
```

### 5.1 查看cobbler版本信息

```sh
[root@cobbler-master ~]# cobbler version
Cobbler 2.8.5
  source: ?, ?
  build time: Tue Oct 15 01:59:43 2019
[root@cobbler-master ~]# 
```

### 5.2 查看cobbler帮助信息

```sh
[root@cobbler-master ~]# cobbler --help
usage
=====
cobbler <distro|profile|system|repo|image|mgmtclass|package|file> ... 
        [add|edit|copy|getks*|list|remove|rename|report] [options|--help]
cobbler <aclsetup|buildiso|import|list|replicate|report|reposync|sync|validateks|version|signature|get-loaders|hardlink> [options|--help]
[root@cobbler-master ~]# 
```



## 6. 检查cobbler配置

可以使用`cobbler check`来检查cobbler的配置，看还存在哪些问题。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : The 'server' field in /etc/cobbler/settings must be set to something other than localhost, or kickstarting features will not work.  This should be a resolvable hostname or IP for the boot server as reachable by all machines that will use it.
2 : For PXE to be functional, the 'next_server' field in /etc/cobbler/settings must be set to something other than 127.0.0.1, and should match the IP of the boot server on the PXE network.
3 : change 'disable' to 'no' in /etc/xinetd.d/tftp
4 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.
5 : enable and start rsyncd.service with systemctl
6 : debmirror package is not installed, it will be required to manage debian deployments and repositories
7 : The default password used by the sample templates for newly installed machines (default_password_crypted in /etc/cobbler/settings) is still set to 'cobbler' and should be changed, try: "openssl passwd -1 -salt 'random-phrase-here' 'your-password-here'" to generate new one
8 : fencing tools were not found, and are required to use the (optional) power management features. install cman or fence-agents to use them

Restart cobblerd and then run 'cobbler sync' to apply changes.
[root@cobbler-master ~]# 
```

可以看到，存在8个问题：

- 问题1，配置文件`/etc/cobbler/settings`中需要配置`server`字段。
- 问题2，配置文件`/etc/cobbler/settings`中需要配置`next_server`字段。
- 问题3，配置文件`/etc/xinetd.d/tftp`需要将`disable`字段设置为`no`。
- 问题4，需要下载网络加载程序。
- 问题5，需要开启`rsyncd`服务。
- 问题6，需要下载安装`debmirror`包，用于管理 debian相关的部署、
- 问题7，配置文件`/etc/cobbler/settings`中需要配置`default_password_crypted`字段。修改默认的密码。
- 问题8，需要安装`fencing tools`工具，进行电源管理。

可以将问题6和问题8分为一类，缺失软件包，需要安装。

可以将问题1、问题2、问题7分为一类，cobbler配置文件配置。

问题3、问题4、问题5单独处理。

### 6.1 安装缺失包

我们首先处理问题6和问题8，将缺失的包安装上。

查看官方文档 [https://cobbler.readthedocs.io/en/latest/user-guide.html#power-management](https://cobbler.readthedocs.io/en/latest/user-guide.html#power-management)：

> 7.9. Power Management
>
> Cobbler contains a power management feature that allows the user to associate system records in Cobbler with the power management configuration attached to them. This can ease installation by making it easy to reassign systems to new operating systems and then reboot those systems.

即：

> 7.9。 能源管理
>
> Cobbler包含一个电源管理功能，允许用户将System Records与其连接的电源管理配置相关联。 这可以通过简单地将系统重新分配给新的操作系统，然后重新启动这些系统来简化安装。

而debmirror包是用于安装ubuntu或debian系统时需要使用的。如果仅需要安装centos系统，则可以不用安装。为了消除这个异常提示，我们还是安装一下。

安装缺失包：

```sh
[root@cobbler-master ~]# yum install debmirror fence-agents -y
... 省略
Installed:
  debmirror.noarch 1:2.30-4.el7                            fence-agents-all.x86_64 0:4.2.1-41.el7_9.4                           

Dependency Installed:
  OpenIPMI.x86_64 0:2.0.27-1.el7                                 OpenIPMI-libs.x86_64 0:2.0.27-1.el7                            
  OpenIPMI-modalias.x86_64 0:2.0.27-1.el7                        audit-libs-python.x86_64 0:2.8.5-4.el7                         
  autogen-libopts.x86_64 0:5.18-5.el7                            bzip2.x86_64 0:1.0.6-13.el7                                    
  checkpolicy.x86_64 0:2.5-8.el7                                 device-mapper-multipath.x86_64 0:0.4.9-134.el7_9               
  device-mapper-multipath-libs.x86_64 0:0.4.9-134.el7_9          ed.x86_64 0:1.9-4.el7                                          
  fence-agents-amt-ws.x86_64 0:4.2.1-41.el7_9.4                  fence-agents-apc.x86_64 0:4.2.1-41.el7_9.4                     
  fence-agents-apc-snmp.x86_64 0:4.2.1-41.el7_9.4                fence-agents-bladecenter.x86_64 0:4.2.1-41.el7_9.4             
  fence-agents-brocade.x86_64 0:4.2.1-41.el7_9.4                 fence-agents-cisco-mds.x86_64 0:4.2.1-41.el7_9.4               
  fence-agents-cisco-ucs.x86_64 0:4.2.1-41.el7_9.4               fence-agents-common.x86_64 0:4.2.1-41.el7_9.4                  
  fence-agents-compute.x86_64 0:4.2.1-41.el7_9.4                 fence-agents-drac5.x86_64 0:4.2.1-41.el7_9.4                   
  fence-agents-eaton-snmp.x86_64 0:4.2.1-41.el7_9.4              fence-agents-emerson.x86_64 0:4.2.1-41.el7_9.4                 
  fence-agents-eps.x86_64 0:4.2.1-41.el7_9.4                     fence-agents-heuristics-ping.x86_64 0:4.2.1-41.el7_9.4         
  fence-agents-hpblade.x86_64 0:4.2.1-41.el7_9.4                 fence-agents-ibmblade.x86_64 0:4.2.1-41.el7_9.4                
  fence-agents-ifmib.x86_64 0:4.2.1-41.el7_9.4                   fence-agents-ilo-moonshot.x86_64 0:4.2.1-41.el7_9.4            
  fence-agents-ilo-mp.x86_64 0:4.2.1-41.el7_9.4                  fence-agents-ilo-ssh.x86_64 0:4.2.1-41.el7_9.4                 
  fence-agents-ilo2.x86_64 0:4.2.1-41.el7_9.4                    fence-agents-intelmodular.x86_64 0:4.2.1-41.el7_9.4            
  fence-agents-ipdu.x86_64 0:4.2.1-41.el7_9.4                    fence-agents-ipmilan.x86_64 0:4.2.1-41.el7_9.4                 
  fence-agents-kdump.x86_64 0:4.2.1-41.el7_9.4                   fence-agents-mpath.x86_64 0:4.2.1-41.el7_9.4                   
  fence-agents-redfish.x86_64 0:4.2.1-41.el7_9.4                 fence-agents-rhevm.x86_64 0:4.2.1-41.el7_9.4                   
  fence-agents-rsa.x86_64 0:4.2.1-41.el7_9.4                     fence-agents-rsb.x86_64 0:4.2.1-41.el7_9.4                     
  fence-agents-sbd.x86_64 0:4.2.1-41.el7_9.4                     fence-agents-scsi.x86_64 0:4.2.1-41.el7_9.4                    
  fence-agents-vmware-rest.x86_64 0:4.2.1-41.el7_9.4             fence-agents-vmware-soap.x86_64 0:4.2.1-41.el7_9.4             
  fence-agents-wti.x86_64 0:4.2.1-41.el7_9.4                     fence-virt.x86_64 0:0.3.2-16.el7                               
  gnutls.x86_64 0:3.3.29-9.el7_6                                 gnutls-dane.x86_64 0:3.3.29-9.el7_6                            
  gnutls-utils.x86_64 0:3.3.29-9.el7_6                           ipmitool.x86_64 0:1.8.18-9.el7_7                               
  libcgroup.x86_64 0:0.41-21.el7                                 libevent.x86_64 0:2.0.21-4.el7                                 
  libsemanage-python.x86_64 0:2.5-14.el7                         libwsman1.x86_64 0:2.6.3-7.git4391e5c.el7                      
  net-snmp-libs.x86_64 1:5.7.2-49.el7_9.1                        net-snmp-utils.x86_64 1:5.7.2-49.el7_9.1                       
  nettle.x86_64 0:2.7.1-9.el7_9                                  openwsman-python.x86_64 0:2.6.3-7.git4391e5c.el7               
  patch.x86_64 0:2.7.1-12.el7_7                                  perl-Business-ISBN.noarch 0:2.06-2.el7                         
  perl-Business-ISBN-Data.noarch 0:20120719.001-2.el7            perl-Compress-Raw-Bzip2.x86_64 0:2.061-3.el7                   
  perl-Compress-Raw-Zlib.x86_64 1:2.061-4.el7                    perl-Data-Dumper.x86_64 0:2.145-3.el7                          
  perl-Digest.noarch 0:1.17-245.el7                              perl-Digest-MD5.x86_64 0:2.52-3.el7                            
  perl-Digest-SHA.x86_64 1:5.85-4.el7                            perl-Encode-Locale.noarch 0:1.03-5.el7                         
  perl-File-Listing.noarch 0:6.04-7.el7                          perl-HTML-Parser.x86_64 0:3.71-4.el7                           
  perl-HTML-Tagset.noarch 0:3.20-15.el7                          perl-HTTP-Cookies.noarch 0:6.01-5.el7                          
  perl-HTTP-Daemon.noarch 0:6.01-8.el7                           perl-HTTP-Date.noarch 0:6.02-8.el7                             
  perl-HTTP-Message.noarch 0:6.06-6.el7                          perl-HTTP-Negotiate.noarch 0:6.01-5.el7                        
  perl-IO-Compress.noarch 0:2.061-2.el7                          perl-IO-HTML.noarch 0:1.00-2.el7                               
  perl-IO-Socket-INET6.noarch 0:2.69-5.el7                       perl-IO-Socket-IP.noarch 0:0.21-5.el7                          
  perl-IO-Socket-SSL.noarch 0:1.94-7.el7                         perl-LWP-MediaTypes.noarch 0:6.02-2.el7                        
  perl-LockFile-Simple.noarch 0:0.208-1.el7                      perl-Mozilla-CA.noarch 0:20130114-5.el7                        
  perl-Net-HTTP.noarch 0:6.06-2.el7                              perl-Net-INET6Glue.noarch 0:0.5-3.el7                          
  perl-Net-LibIDN.x86_64 0:0.12-15.el7                           perl-Net-SSLeay.x86_64 0:1.55-6.el7                            
  perl-Socket6.x86_64 0:0.23-15.el7                              perl-TimeDate.noarch 1:2.30-2.el7                              
  perl-URI.noarch 0:1.60-9.el7                                   perl-WWW-RobotRules.noarch 0:6.02-5.el7                        
  perl-libwww-perl.noarch 0:6.05-2.el7                           pexpect.noarch 0:2.3-11.el7                                    
  policycoreutils-python.x86_64 0:2.5-34.el7                     python-IPy.noarch 0:0.75-6.el7                                 
  python-requests.noarch 0:2.6.0-10.el7                          python-six.noarch 0:1.9.0-2.el7                                
  python-suds.noarch 0:0.4.1-5.el7                               python-urllib3.noarch 0:1.10.2-7.el7                           
  setools-libs.x86_64 0:3.3.8-4.el7                              sg3_utils.x86_64 1:1.37-19.el7                                 
  sg3_utils-libs.x86_64 1:1.37-19.el7                            telnet.x86_64 1:0.17-66.el7                                    
  trousers.x86_64 0:0.3.14-2.el7                                 unbound-libs.x86_64 0:1.6.6-5.el7_8                            

Dependency Updated:
  kpartx.x86_64 0:0.4.9-134.el7_9                                                                                               

Complete!
[root@cobbler-master ~]# 
```

安装完成后，再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : The 'server' field in /etc/cobbler/settings must be set to something other than localhost, or kickstarting features will not work.  This should be a resolvable hostname or IP for the boot server as reachable by all machines that will use it.
2 : For PXE to be functional, the 'next_server' field in /etc/cobbler/settings must be set to something other than 127.0.0.1, and should match the IP of the boot server on the PXE network.
3 : change 'disable' to 'no' in /etc/xinetd.d/tftp
4 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.
5 : enable and start rsyncd.service with systemctl
6 : comment out 'dists' on /etc/debmirror.conf for proper debian support
7 : comment out 'arches' on /etc/debmirror.conf for proper debian support
8 : The default password used by the sample templates for newly installed machines (default_password_crypted in /etc/cobbler/settings) is still set to 'cobbler' and should be changed, try: "openssl passwd -1 -salt 'random-phrase-here' 'your-password-here'" to generate new one

Restart cobblerd and then run 'cobbler sync' to apply changes.
[root@cobbler-master ~]# 
```

可以看到，此时多出了问题6和问题7是和`debmirror`相关的。我们处理一下配置文件`/etc/debmirror.conf`。为了支持debian，需要将`dists`和`arches`配置给注释掉。

查看配置文件`/etc/debmirror.conf`的内容：

```sh
[root@cobbler-master ~]# cat -n /etc/debmirror.conf 
     1	# Default config for debmirror
     2	
     3	# The config file is a perl script so take care to follow perl syntax.
     4	# Any setting in /etc/debmirror.conf overrides these defaults and
     5	# ~/.debmirror.conf overrides those again. Take only what you need.
     6	#
     7	# The syntax is the same as on the command line and variable names
     8	# loosely match option names. If you don't recognize something here
     9	# then just stick to the command line.
    10	#
    11	# Options specified on the command line override settings in the config
    12	# files.
    13	
    14	# Location of the local mirror (use with care)
    15	# $mirrordir="/path/to/mirrordir"
    16	
    17	# Output options
    18	$verbose=0;
    19	$progress=0;
    20	$debug=0;
    21	
    22	# Download options
    23	$host="ftp.debian.org";
    24	$user="anonymous";
    25	$passwd="anonymous@";
    26	$remoteroot="debian";
    27	$download_method="ftp";
    28	@dists="sid";
    29	@sections="main,main/debian-installer,contrib,non-free";
    30	@arches="i386";
    31	# @ignores="";
    32	# @excludes="";
    33	# @includes="";
    34	# @excludes_deb_section="";
    35	# @limit_priority="";
    36	$omit_suite_symlinks=0;
    37	$skippackages=0;
    38	# @rsync_extra="doc,tools";
    39	$i18n=0;
    40	$getcontents=0;
    41	$do_source=1;
    42	$max_batch=0;
    43	
    44	# @di_dists="dists";
    45	# @di_archs="arches";
    46	
    47	# Save mirror state between runs; value sets validity of cache in days
    48	$state_cache_days=0;
    49	
    50	# Security/Sanity options
    51	$ignore_release_gpg=0;
    52	$ignore_release=0;
    53	$check_md5sums=0;
    54	$ignore_small_errors=0;
    55	
    56	# Cleanup
    57	$cleanup=0;
    58	$post_cleanup=1;
    59	
    60	# Locking options
    61	$timeout=300;
    62	
    63	# Rsync options
    64	$rsync_batch=200;
    65	$rsync_options="-aIL --partial";
    66	
    67	# FTP/HTTP options
    68	$passive=0;
    69	# $proxy="http://proxy:port/";
    70	
    71	# Dry run
    72	$dry_run=0;
    73	
    74	# Don't keep diff files but use them
    75	$diff_mode="use";
    76	
    77	# The config file must return true or perl complains.
    78	# Always copy this.
    79	1;
[root@cobbler-master ~]# 
[root@cobbler-master ~]# cat -n /etc/debmirror.conf|grep 'dists' 
    28	@dists="sid";
    44	# @di_dists="dists";
[root@cobbler-master ~]# cat -n /etc/debmirror.conf|grep 'arches' 
    30	@arches="i386";
    45	# @di_archs="arches";
```

我们把28行和30行的配置替换掉。

```sh
# 尝试替换
[root@cobbler-master ~]# sed -n 's/@dists=/# @dists=/gp' /etc/debmirror.conf 
# @dists="sid";
[root@cobbler-master ~]# sed -n 's/@arches=/# @arches=/gp' /etc/debmirror.conf 
# @arches="i386";

# 直接替换文件内容
[root@cobbler-master ~]# sed -i 's/@dists=/# @dists=/g' /etc/debmirror.conf 
[root@cobbler-master ~]# sed -i 's/@arches=/# @arches=/g' /etc/debmirror.conf 

# 再次查看配置信息
[root@cobbler-master ~]# cat -n /etc/debmirror.conf|grep 'dists' 
    28	# @dists="sid";
    44	# @di_dists="dists";
[root@cobbler-master ~]# cat -n /etc/debmirror.conf|grep 'arches' 
    30	# @arches="i386";
    45	# @di_archs="arches";
```

可以看到`@dists`和`@arches`行已经注释掉了。

再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : The 'server' field in /etc/cobbler/settings must be set to something other than localhost, or kickstarting features will not work.  This should be a resolvable hostname or IP for the boot server as reachable by all machines that will use it.
2 : For PXE to be functional, the 'next_server' field in /etc/cobbler/settings must be set to something other than 127.0.0.1, and should match the IP of the boot server on the PXE network.
3 : change 'disable' to 'no' in /etc/xinetd.d/tftp
4 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.
5 : enable and start rsyncd.service with systemctl
6 : The default password used by the sample templates for newly installed machines (default_password_crypted in /etc/cobbler/settings) is still set to 'cobbler' and should be changed, try: "openssl passwd -1 -salt 'random-phrase-here' 'your-password-here'" to generate new one

Restart cobblerd and then run 'cobbler sync' to apply changes.
```

可以发现`debmirror`异常已经没有了。



### 6.2  cobbler配置文件修改

本节涉及到第二类问题，`server`、`next_server`和`default_password_crypted`的修改。

在修改配置文件前，我们开启下动态更新配置文件开关。

查看官方文档 [https://cobbler.readthedocs.io/en/latest/cobbler-conf.html#allow-dynamic-settings](https://cobbler.readthedocs.io/en/latest/cobbler-conf.html#allow-dynamic-settings)

> ### allow_dynamic_settings
>
> If `True`, Cobbler will allow settings to be changed dynamically without a restart of the `cobblerd` daemon. You can only change this variable by manually editing the settings file, and you MUST restart `cobblerd` after changing it.
>
> default: `False`

可以知道。通过开启该配置，可以在修改配置文件后，不需要重置cobblerd服务。因此我们先手动修改一下该配置，并重置cobblerd服务，后面再修改配置就不需要重置了。

修改前，先备份配置文件。

```sh
[root@cobbler-master ~]# cp /etc/cobbler/settings{,.bak}
[root@cobbler-master ~]# ls /etc/cobbler/settings*
/etc/cobbler/settings  /etc/cobbler/settings.bak
```

查看当前allow_dynamic_settings配置信息：

```sh
[root@cobbler-master ~]# grep 'allow_dynamic_settings' /etc/cobbler/settings
allow_dynamic_settings: 0


# 获取帮助信息
[root@cobbler-master ~]# cobbler setting --help
usage
=====
cobbler setting edit
cobbler setting report
[root@cobbler-master ~]# cobbler setting report --help
Usage: cobbler [options]

Options:
  -h, --help   show this help message and exit
  --name=NAME  name of object
  
  
# 查看当前allow_dynamic_settings的配置信息  
[root@cobbler-master ~]# cobbler setting report --name=allow_dynamic_settings
allow_dynamic_settings                  : 0
```

我们使用`sed`命令替换掉：

```sh
# 尝试替换
[root@cobbler-master ~]# sed -n 's/allow_dynamic_settings: 0/allow_dynamic_settings: 1/gp' /etc/cobbler/settings
allow_dynamic_settings: 1

# 直接替换文件中内容
[root@cobbler-master ~]# sed -i 's/allow_dynamic_settings: 0/allow_dynamic_settings: 1/g' /etc/cobbler/settings

# 再次查看配置文件
[root@cobbler-master ~]# grep 'allow_dynamic_settings' /etc/cobbler/settings
allow_dynamic_settings: 1
```

重启`cobblerd`服务：

```sh
[root@cobbler-master ~]# systemctl restart cobblerd && systemctl status cobblerd
● cobblerd.service - Cobbler Helper Daemon
   Loaded: loaded (/usr/lib/systemd/system/cobblerd.service; enabled; vendor preset: disabled)
   Active: active (running) since 六 2021-06-19 12:13:18 CST; 20ms ago
  Process: 2120 ExecStartPost=/usr/bin/touch /usr/share/cobbler/web/cobbler.wsgi (code=exited, status=0/SUCCESS)
 Main PID: 2119 (cobblerd)
   CGroup: /system.slice/cobblerd.service
           └─2119 /usr/bin/python2 -s /usr/bin/cobblerd -F

6月 19 12:13:18 cobbler-master systemd[1]: Stopped Cobbler Helper Daemon.
6月 19 12:13:18 cobbler-master systemd[1]: Starting Cobbler Helper Daemon...
6月 19 12:13:18 cobbler-master systemd[1]: Started Cobbler Helper Daemon.
[root@cobbler-master ~]# 
```

下面我们开始修改配置文件。

#### 6.2.1 修改`server`和`next_server`配置

- `server`选项是指cobbler server的ip地址，修改服务器的IP地址`192.168.2.20`。
- `next_server`选项被用在DHCP/PXE上，用来作为DHCP Server和TFTP Server的IP地址，一般和Cobbler服务地址使用一个IP。

我们使用命令`cobbler setting edit`命令来动态更新配置文件

```sh
# 获取帮助信息
[root@cobbler-master ~]# cobbler setting edit --help
Usage: cobbler [options]

Options:
  -h, --help     show this help message and exit
  --name=NAME    Name (Ex: server)
  --value=VALUE  Value (Ex: 127.0.0.1)

# 获取帮助信息
[root@cobbler-master ~]# cobbler setting report --help
Usage: cobbler [options]

Options:
  -h, --help   show this help message and exit
  --name=NAME  name of object
```

先查看一下配置信息：

```sh
[root@cobbler-master ~]# cobbler setting report --name=server
server                                  : 127.0.0.1
[root@cobbler-master ~]# cobbler setting report --name=next_server
next_server                             : 127.0.0.1
```

更新：

```sh
[root@cobbler-master ~]# cobbler setting edit --name=server --value="192.168.2.20"
[root@cobbler-master ~]# cobbler setting edit --name=next_server --value="192.168.2.20"
[root@cobbler-master ~]# cobbler setting report --name=server
server                                  : 192.168.2.20
[root@cobbler-master ~]# cobbler setting report --name=next_server
next_server                             : 192.168.2.20
```

可以看到`server`和`next_server`配置已经更新成功。

再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : change 'disable' to 'no' in /etc/xinetd.d/tftp
2 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.
3 : enable and start rsyncd.service with systemctl
4 : The default password used by the sample templates for newly installed machines (default_password_crypted in /etc/cobbler/settings) is still set to 'cobbler' and should be changed, try: "openssl passwd -1 -salt 'random-phrase-here' 'your-password-here'" to generate new one

Restart cobblerd and then run 'cobbler sync' to apply changes.
[root@cobbler-master ~]# 
```

可能发现`server`和`next_server`异常已经没有了。



搓着处理`default_password_crypted`配置的问题。

#### 6.2.2 修改`default_password_crypted`配置

`default_password_crypted`配置用于指定安装新系统时`root`账号的密码。

按提示可以使用命令`openssl passwd -1 -salt 'random-phrase-here' 'your-password-here'`生成加密的密码。

查看默认密码：

```sh
[root@cobbler-master ~]# cobbler setting report --name=default_password_crypted
default_password_crypted                : $1$mF86/UHC$WvcIcX2t6crBz2onWxyac.
```

可以看到，这是一个加密后的密码字符串。

我们需要更新该密码。假设我们使用`admin.CB@nodes1234`作为新的系统的默认密码(注意，该密码不要让别人知道，此处我是随意取的)。那么我们需要进行以下处理，生成加密后的密码字符串。



生成随机盐：

```sh
[root@cobbler-master ~]# openssl rand --help
Usage: rand [options] num
where options are
-out file             - write to file
-engine e             - use engine e, possibly a hardware device.
-rand file:file:... - seed PRNG from files
-base64               - base64 encode output
-hex                  - hex encode output
[root@cobbler-master ~]# salt=$( openssl rand -hex 6 )
[root@cobbler-master ~]# echo $salt
ccd64bfd742f
```

使用刚才生成的随机盐进行密码加密：

```sh
[root@cobbler-master ~]# openssl passwd --help
Usage: passwd [options] [passwords]
where options are
-crypt             standard Unix password algorithm (default)
-1                 MD5-based password algorithm
-apr1              MD5-based password algorithm, Apache variant
-salt string       use provided salt
-in file           read passwords from file
-stdin             read passwords from stdin
-noverify          never verify when reading password from terminal
-quiet             no warnings
-table             format output as table
-reverse           switch table columns
[root@cobbler-master ~]# scpasswd=$( openssl passwd -1 -salt "${salt}" "admin.CB@nodes1234" )
[root@cobbler-master ~]# echo $scpasswd 
$1$ccd64bfd$5VwI.zd5m7wpraFvvClhT.
```

更新默认密码：

```sh
[root@cobbler-master ~]# cobbler setting edit --name=default_password_crypted --value="${scpasswd}"
[root@cobbler-master ~]# cobbler setting report --name=default_password_crypted
default_password_crypted                : $1$ccd64bfd$5VwI.zd5m7wpraFvvClhT.
```

再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : change 'disable' to 'no' in /etc/xinetd.d/tftp
2 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.
3 : enable and start rsyncd.service with systemctl

Restart cobblerd and then run 'cobbler sync' to apply changes.
[root@cobbler-master ~]# 
```

可以看到，cobbler配置文件相关的异常已经没有了。

### 6.3 修改TFTP配置文件

先备份配置文件`/etc/xinetd.d/tftp`:

```sh
[root@cobbler-master ~]# cp /etc/xinetd.d/tftp{,.bak}
[root@cobbler-master ~]# ls /etc/xinetd.d/tftp*
/etc/xinetd.d/tftp  /etc/xinetd.d/tftp.bak
```

查看配置内容：

```sh
[root@cobbler-master ~]# cat -n /etc/xinetd.d/tftp
     1	# default: off
     2	# description: The tftp server serves files using the trivial file transfer \
     3	#	protocol.  The tftp protocol is often used to boot diskless \
     4	#	workstations, download configuration files to network-aware printers, \
     5	#	and to start the installation process for some operating systems.
     6	service tftp
     7	{
     8		socket_type		= dgram
     9		protocol		= udp
    10		wait			= yes
    11		user			= root
    12		server			= /usr/sbin/in.tftpd
    13		server_args		= -s /var/lib/tftpboot
    14		disable			= yes
    15		per_source		= 11
    16		cps			= 100 2
    17		flags			= IPv4
    18	}
[root@cobbler-master ~]# 
```

将第14行的`disable			= yes`改成`disable			= no`。修改后配置文件 如下：

```sh
[root@cobbler-master ~]# cat -n /etc/xinetd.d/tftp
     1	# default: off
     2	# description: The tftp server serves files using the trivial file transfer \
     3	#	protocol.  The tftp protocol is often used to boot diskless \
     4	#	workstations, download configuration files to network-aware printers, \
     5	#	and to start the installation process for some operating systems.
     6	service tftp
     7	{
     8		socket_type		= dgram
     9		protocol		= udp
    10		wait			= yes
    11		user			= root
    12		server			= /usr/sbin/in.tftpd
    13		server_args		= -s /var/lib/tftpboot
    14		disable			= no
    15		per_source		= 11
    16		cps			= 100 2
    17		flags			= IPv4
    18	}
```

启动`xinetd`服务：

```sh
# 设置开机自启动
[root@cobbler-master ~]# systemctl enable xinetd

# 启动xinetd服务，并查看服务状态
[root@cobbler-master ~]# systemctl start xinetd && systemctl status xinetd
● xinetd.service - Xinetd A Powerful Replacement For Inetd
   Loaded: loaded (/usr/lib/systemd/system/xinetd.service; enabled; vendor preset: enabled)
   Active: active (running) since 六 2021-06-19 14:49:10 CST; 4ms ago
  Process: 2310 ExecStart=/usr/sbin/xinetd -stayalive -pidfile /var/run/xinetd.pid $EXTRAOPTIONS (code=exited, status=0/SUCCESS)
 Main PID: 2311 (xinetd)
   CGroup: /system.slice/xinetd.service
           └─2311 /usr/sbin/xinetd -stayalive -pidfile /var/run/xinetd.pid

6月 19 14:49:10 cobbler-master xinetd[2311]: removing discard
6月 19 14:49:10 cobbler-master xinetd[2311]: removing discard
6月 19 14:49:10 cobbler-master xinetd[2311]: removing echo
6月 19 14:49:10 cobbler-master xinetd[2311]: removing echo
6月 19 14:49:10 cobbler-master xinetd[2311]: removing tcpmux
6月 19 14:49:10 cobbler-master xinetd[2311]: removing time
6月 19 14:49:10 cobbler-master xinetd[2311]: removing time
6月 19 14:49:10 cobbler-master xinetd[2311]: xinetd Version 2.3.15 started with libwrap loadavg labeled-networking opt...ed in.
6月 19 14:49:10 cobbler-master xinetd[2311]: Started working: 1 available service
6月 19 14:49:10 cobbler-master systemd[1]: Started Xinetd A Powerful Replacement For Inetd.
Hint: Some lines were ellipsized, use -l to show in full.
```

可以看到服务已经正常启动。这样TFTP服务就启动成功了。

我们再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.
2 : enable and start rsyncd.service with systemctl

Restart cobblerd and then run 'cobbler sync' to apply changes.
```

可以看到只剩下两个问题需要处理了。

### 6.4 启动rsyncd服务

rsync是一种快速且极其通用的文件复制工具。我们使用以下命令将该服务启动起来。

````sh
[root@cobbler-master ~]# systemctl enable rsyncd
Created symlink from /etc/systemd/system/multi-user.target.wants/rsyncd.service to /usr/lib/systemd/system/rsyncd.service.
[root@cobbler-master ~]# systemctl start rsyncd && systemctl status rsyncd
● rsyncd.service - fast remote file copy program daemon
   Loaded: loaded (/usr/lib/systemd/system/rsyncd.service; enabled; vendor preset: disabled)
   Active: active (running) since 六 2021-06-19 14:56:21 CST; 6ms ago
 Main PID: 2350 (rsync)
   CGroup: /system.slice/rsyncd.service
           └─2350 /usr/bin/rsync --daemon --no-detach

6月 19 14:56:21 cobbler-master systemd[1]: Started fast remote file copy program daemon.
6月 19 14:56:21 cobbler-master rsyncd[2350]: rsyncd version 3.1.2 starting, listening on port 873
[root@cobbler-master ~]# 
````

可以看到`rsyncd`服务已经启动成功，并监听`873`端口。

我们再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : Some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run 'cobbler get-loaders' to download them, or, if you only want to handle x86/x86_64 netbooting, you may ensure that you have installed a *recent* version of the syslinux package installed and can ignore this message entirely.  Files in this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The 'cobbler get-loaders' command is the easiest way to resolve these requirements.

Restart cobblerd and then run 'cobbler sync' to apply changes.
```

可以看到，只有最后一个问题需要处理了。

### 6.5 下载网络启动器文件

按提示信息，直接运行命令`cobbler get-loaders`:

```sh
# 运行第1次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150035_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:00:35 2021)
downloading https://cobbler.github.io/loaders/README to /var/lib/cobbler/loaders/README
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!

# 运行第2次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150041_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:00:41 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/COPYING.elilo to /var/lib/cobbler/loaders/COPYING.elilo
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!

# 运行第3次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150055_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:00:55 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/COPYING.yaboot to /var/lib/cobbler/loaders/COPYING.yaboot
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 

# 运行第4次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150140_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:01:40 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/COPYING.syslinux to /var/lib/cobbler/loaders/COPYING.syslinux
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 

# 运行第5次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150217_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:02:17 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/elilo-3.8-ia64.efi to /var/lib/cobbler/loaders/elilo-ia64.efi
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 

# 运行第6次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150247_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:02:47 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/elilo-ia64.efi already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/yaboot-1.3.17 to /var/lib/cobbler/loaders/yaboot
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]#

# 运行第7次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150327_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:03:27 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/elilo-ia64.efi already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/yaboot already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/pxelinux.0-3.86 to /var/lib/cobbler/loaders/pxelinux.0
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 

# 运行第8次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150342_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:03:42 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/elilo-ia64.efi already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/pxelinux.0 already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/menu.c32-3.86 to /var/lib/cobbler/loaders/menu.c32
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 


# 运行第9次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150416_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:04:16 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/elilo-ia64.efi already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/pxelinux.0 already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/menu.c32 already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/grub-0.97-x86.efi to /var/lib/cobbler/loaders/grub-x86.efi
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 

# 运行第10次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150443_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:04:43 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/elilo-ia64.efi already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/pxelinux.0 already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/menu.c32 already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/grub-x86.efi already exists, not overwriting existing content, use --force if you wish to update
downloading https://cobbler.github.io/loaders/grub-0.97-x86_64.efi to /var/lib/cobbler/loaders/grub-x86_64.efi
Exception occured: <class 'urlgrabber.grabber.URLGrabError'>
Exception value: [Errno 14] curl#60 - "Issuer certificate is invalid."
Exception Info:
  File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 82, in run
    rc = self._run(self)
   File "/usr/lib/python2.7/site-packages/cobbler/remote.py", line 176, in runner
    return self.remote.api.dlcontent(self.options.get("force",False), self.logger)
   File "/usr/lib/python2.7/site-packages/cobbler/api.py", line 735, in dlcontent
    return grabber.run(force)
   File "/usr/lib/python2.7/site-packages/cobbler/action_dlcontent.py", line 73, in run
    urlgrabber.grabber.urlgrab(src, filename=dst, proxies=proxies)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 773, in urlgrab
    return default_grabber.urlgrab(url, filename, **kwargs)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1220, in urlgrab
    return _run_callback(opts.failfunc, opts)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1071, in _run_callback
    return cb(obj)
   File "/usr/lib/python2.7/site-packages/urlgrabber/grabber.py", line 1065, in _do_raise
    raise obj.exception

!!! TASK FAILED !!!
[root@cobbler-master ~]# 


# 运行第11次
[root@cobbler-master ~]# cobbler get-loaders
task started: 2021-06-19_150515_get_loaders
task started (id=Download Bootloader Content, time=Sat Jun 19 15:05:15 2021)
path /var/lib/cobbler/loaders/README already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.elilo already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/COPYING.syslinux already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/elilo-ia64.efi already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/yaboot already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/pxelinux.0 already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/menu.c32 already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/grub-x86.efi already exists, not overwriting existing content, use --force if you wish to update
path /var/lib/cobbler/loaders/grub-x86_64.efi already exists, not overwriting existing content, use --force if you wish to update
*** TASK COMPLETE ***
[root@cobbler-master ~]# echo $?
0
```

在执行命令的过程中，发现命令每次都在下载文件，因此经过多次下载后，所有的问题都下载完了，最后显示`*** TASK COMPLETE ***`说明任务执行完成了。

我们再使用`cobbler check`进行检查一次。

```sh
[root@cobbler-master ~]# cobbler check
No configuration problems found.  All systems go.
```

这个时候提示没有配置问题，说明所有异常都解决了。







参考：

- [EPEL镜像](https://mirrors.tuna.tsinghua.edu.cn/help/epel/)
- [CentOS镜像](https://repo.huaweicloud.com/centos/)
- [Cobbler自动化部署](https://www.cnblogs.com/yanjieli/p/11016825.html)

